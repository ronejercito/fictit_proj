{% load static %}
<div class="p-0">
	<div class="border rounded mb-2 mx-0 p-2 d-flex flex-row justify-content-between align-items-center">
		<h5><span class="align-middle mx-3 my-0 p-0">Comments</span></h5>
		<a href="#" data-modal-title="" class="btn btn-link border px-3" data-modal-url="" data-toggle="modal" data-target="#commentModal">+</a>
	</div>
	{% for comment in comments %}
	<div class="card">
		<div class="card-body p-3">
			<div class="d-flex justify-content-between align-middle mb-2 p-0">
				<h6 class="card-title">{{ comment.commenter }} commented</h5>
				<form method="post" action="{% url 'author:comment_delete' storyslug=request.resolver_match.kwargs.storyslug storypageslug=request.resolver_match.kwargs.storypageslug comment_pk=comment.id %}">
					{% csrf_token %}
					<input type="submit" value="&times;" class="text-muted btn btn-link border rounded p-1 px-2 m-0">
				</form>
			</div>
				
			<h6 class="card-subtitle mb-2 text-muted">{{ comment.updated.date}}</h6>
			<span class="card-text">{{ comment.text }}</span>
			<div class="row mt-2 d-flex justify-content-between align-items-center">
				
				<div class="col-9">
					{% if comment.resolved %}
					<p class="text-muted m-0 p-0">Resolved on {{ comment.resolve_date.date }} {{ comment.resolve_date.time }}</p>
					{% endif %}
				</div>
				
				<div class="col-3 d-flex justify-content-end"><a href="{% url 'author:comment_update' storyslug=request.resolver_match.kwargs.storyslug storypageslug=request.resolver_match.kwargs.storypageslug comment_pk=comment.id %}" data-modal-title="" data-modal-url="" data-toggle="modal" data-target="#commentModal" class="btn btn-outline-primary">Update</a></div>
			</div>
				
		</div>		
	</div>
	{% endfor %}
</div>

{% if request.resolver_match.view_name == 'author:storypage_update' %}
{% block extra_body %}
<div class="modal fade" id="commentModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add Comment</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        {% include 'authoring/modals/add_comment.html' %}
      </div>
    </div>
  </div>
</div>
{% endblock extra_body %}
{% endif %}